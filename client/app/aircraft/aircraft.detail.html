<div class="container">
  <div class="aircraft-detail">
      <h2 ng-hide="!aircraft.reg_no">{{aircraft.reg_no | lsaRegNo}}</h2>
      <div id="aircraft_image" ng-hide="showcmd==='add' && !showimage" ng-controller="AImageCtrl" ng-init="init(aimages)">
        <a-images></a-images>
      </div>
      <form name="form" class="aircraft-detail-form form-horizontal">
        <fieldset>
            <div class="panel panel-default form-group">
                <div class="panel-heading">등록정보</div>
                <table class="table table-bordered table-condensed">
                    <tbody>
                        <tr class="form-group">
                            <td>
                                <label for="reg_no" class="control-label">{{regLabel}}</label>
                            </td>
                            <td colspan="3" ng-class="{'has-error': form.reg_no.$invalid, 'has-success': !form.reg_no.$invalid}">
                                <input type="text" name="reg_no" class="form-control input-sm" value="{{aircraft.reg_no | lsaRegNo}}" placeholder="{{regLabel}}" ng-model="aircraft.reg_no" ng-change="regNoChange(aircraft.reg_no)" ui-validate-async="{regcheck: 'regCheckAsync($modelValue)'}" ng-pattern="/^(HLC|HL-C)[\d]{3}$/i" ng-disabled="showcmd!=='add'" required />
                                <div class="error-container" ng-show="form.reg_no.$dirty && form.reg_no.$invalid">
                                    <small class="help-block error" ng-show="form.reg_no.$error.required || form.reg_no.$error.pattern">정확한 등록부호를 입력하여 주십시오(예: HL-C001 등)</small>
                                    <small class="help-block error" ng-show="form.reg_no.$error.regcheck">이미 등록된 번호입니다.</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && form.reg_no.$invalid">
                            <td class="col-sm-2">
                                <label for="reg_status" class="control-label">등록상태</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.reg_status.$invalid, 'has-success': !form.reg_status.$invalid}">
                                <select name="reg_status" ng-init="enums.regStatuses[0].value" ng-model="aircraft.reg_status" ng-options="regStatus.value as regStatus.label for regStatus in enums.regStatuses" class="form-control"></select>
                            </td>
                            <td class="col-sm-2">
                                <label for="reg_date" class="control-label">등록일자</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.reg_date.$invalid, 'has-success': !form.reg_date.$invalid}">
                                <input type="text" name="reg_date" class="form-control" ng-model="aircraft.reg_date" placeholder="yyyy-MM-dd"  ng-pattern="/^(19|20)\d{2}\-\d{1,2}\-\d{1,2}$/" required />
                                <div class="error-container">
                                    <small class="help-block error" ng-show="form.reg_date.$error.required || form.reg_date.$error.pattern">정확한 등록일자를 입력하여 주십시오(예: 2015-01-01)</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && (form.reg_status.$invalid || form.reg_date.$invalid)">
                            <td class="col-sm-2">
                                <label for="reg_type" class="control-label">등록형태</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.reg_type.$invalid, 'has-success': !form.reg_type.$invalid}">
                                <select name="reg_type" ng-init="enums.regTypes[0].value" ng-model="aircraft.reg_type" ng-options="regType.value as regType.label for regType in enums.regTypes"  ng-change="regTypeChange()" class="form-control" required></select>
                            </td>
                            <td class="col-sm-2">
                                <label for="ulv_no" class="control-label">이전번호</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.ulv_no.$invalid, 'has-success': !form.ulv_no.$invalid}" ng-hide="aircraft.reg_type !== 'ULV'">
                                <input type="text" name="ulv_no" class="form-control" placeholder="이전 초경량신고번호" ng-model="aircraft.ulv_no" ng-pattern=" /^(S|B)[1-6]\d{3}$/"/>
                                <div class="error-container" ng-show="form.ulv_no.$dirty && form.ulv_no.$invalid">
                                    <small class="help-block error" ng-show="form.ulv_no.$error.pattern">정확한 신고번호를 입력하여 주십시오(예: S1234)</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && form.reg_type.$invalid">
                            <td class="col-sm-2">
                                <label for="owner" class="control-label">소유자</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.owner.$invalid, 'has-success': !form.owner.$invalid}">
                                <input type="text" name="owner" class="form-control" placeholder="소유자/회사명" ng-model="aircraft.owner" required/>
                                <div class="error-container" ng-show="form.owner.$dirty && form.owner.$invalid">
                                    <small class="help-block error" ng-show="form.owner.$error.required">정확한 소유자명을 입력하여 주십시오</small>
                                </div>
                            </td>
                            <td class="col-sm-2">
                                <label for="phone" class="control-label">연락처</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.phone.$invalid, 'has-success': !form.phone.$invalid}">
                                <input type="text" name="phone" class="form-control" value="{{aircraft.phone | lsaRegNo}}" placeholder="전화번호(010-1111-1111)" ng-model="aircraft.phone" ng-pattern=" /^[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}$/" />
                                <div class="error-container" ng-show="form.phone.$dirty && form.phone.$invalid">
                                    <small class="help-block error" ng-show="form.phone.$error || form.phone.$error.pattern">정확한 연락처를 입력하여 주십시오(예: 010-1111-1111 등)</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && (form.owner.$invalid || form.phone.$invalid)">
                            <td class="col-sm-2">
                                <label for="region" class="control-label">권역</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.region.$invalid, 'has-success': !form.region.$invalid}">
                                <select name="region" ng-init="enums.regions[0].value" ng-model="aircraft.region" ng-change="regionChange()" ng-options="region.value as region.label for region in enums.regions" class="form-control" required></select>
                            </td>
                            <td class="col-sm-2">
                                <label for="acenter" class="control-label">관할</label>
                            </td>
                            <td class="col-sm-4" ng-class="{'has-error': form.acenter.$invalid, 'has-success': !form.acenter.$invalid}">
                                <select name="acenter" ng-init="enums.aCenters[0].value" ng-model="aircraft.acenter" ng-options="acenter.value as acenter.label for acenter in enums.aCenters" class="form-control" required></select>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && (form.region.$invalid || form.acenter.$invalid)">
                            <td>
                                <label for="place" class="control-label">보관처</label>
                            </td>
                            <td colspan="3" ng-class="{'has-error': form.place.$invalid, 'has-success': !form.place.$invalid}">
                                <input type="text" name="place" class="form-control" placeholder="보관처(주소)" ng-model="aircraft.place" required/>
                                <div class="error-container" ng-show="form.place.$dirty && form.place.$invalid">
                                    <small class="help-block error" ng-show="form.place.$error.required">보관처를 입력하여 주십시오</small>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- <div class="panel panel-default form-group">
                <div class="panel-heading">등록정보</div>
                <div class="panel-body">
                    <div class="form-group" ng-class="{'has-error': form.reg_no.$invalid, 'has-success': !form.reg_no.$invalid}">
                        <label for="reg_no" class="control-label col-sm-2">{{regLabel}}</label>
                        <div class="col-sm-10">
                            <input type="text" name="reg_no" class="form-control" value="{{aircraft.reg_no | lsaRegNo}}" placeholder="{{regLabel}}" ng-model="aircraft.reg_no" ng-change="regNoChange(reg_no)" ng-pattern="/^(HLC|HL-C)[\d]{3}$/" required />
                            <div class="error-container" ng-show="form.reg_no.$dirty && form.reg_no.$invalid">
                                <small class="help-block error" ng-show="form.reg_no.$error.required || form.reg_no.$error.pattern">정확한 등록부호를 입력하여 주십시오(예: HL-C001 등)</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.lsa_category.$invalid, 'has-success': !form.lsa_category.$invalid}">
                        <label for="lsa_category" class="control-label col-sm-2">초경량/경량</label>
                        <div class="col-sm-10">
                            <select id="lsa_category" ng-init="enums.lsaCategories[0].value" ng-model="aircraft.lsa_category" ng-change="catSelChange(aircraft.lsa_category)" ng-options="lsaCategory.value as lsaCategory.label for lsaCategory in enums.lsaCategories" class="form-control"></select>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.model.$invalid, 'has-success': !form.model.$invalid}">
                        <label for="model" class="control-label col-sm-2">형식(모델)명</label>
                        <div class="col-sm-10">
                            <input type="text" name="model" ng-model="aircraft.model" typeahead="item.model as item.desc for item in aircraftModels | filter:$viewValue" typeahead-on-select="selectModel($item, $model, $label)" class="form-control">
                            <div class="error-container" ng-show="form.model.$dirty && form.model.$invalid">
                                <small class="help-block error" ng-show="form.reg_no.$error.required">모델명을 입력하여 주십시오</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.reg_status.$invalid, 'has-success': !form.reg_status.$invalid}">
                        <label for="reg_status" class="control-label col-sm-2">등록상태</label>
                        <div class="col-sm-10">
                            <select id="reg_status" ng-init="enums.regStatuses[0].value" ng-model="aircraft.reg_status" ng-options="regStatus.value as regStatus.label for regStatus in enums.regStatuses" class="form-control"></select>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.reg_date.$invalid, 'has-success': !form.reg_date.$invalid}">
                        <label for="reg_date" class="control-label col-sm-2">등록일자</label>
                        <div class="col-sm-10">
                            <input type="text" name="reg_date" class="form-control" ng-model="aircraft.reg_date" placeholder="yyyy-MM-dd" required />
                            <div class="error-container">
                                <small class="help-block error" ng-show="form.reg_date.$error.required || form.reg_date.$error.date">정확한 등록일자를 입력하여 주십시오(예: 2015-01-01)</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.reg_type.$invalid, 'has-success': !form.reg_type.$invalid}">
                        <label for="reg_type" class="control-label col-sm-2">등록형태</label>
                        <div class="col-sm-10">
                            <select name="reg_type" ng-init="enums.regTypes[0].value" ng-model="aircraft.reg_type" ng-options="regType.value as regType.label for regType in enums.regTypes"  ng-change="regTypeChange()" class="form-control"></select>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.ulv_no.$invalid, 'has-success': !form.ulv_no.$invalid}" ng-show="showulvno">
                        <label for="ulv_no" class="control-label col-sm-2">이전번호</label>
                        <div class="col-sm-10">
                            <input type="text" name="ulv_no" class="form-control" placeholder="이전 초경량신고번호" ng-model="aircraft.ulv_no" ng-pattern=" /^(S|B)[1-6]\d{3}$/"/>
                            <div class="error-container" ng-show="form.ulv_no.$dirty && form.ulv_no.$invalid">
                                <small class="help-block error" ng-show="form.ulv_no.$error.pattern">정확한 신고번호를 입력하여 주십시오(예: S1234)</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.owner.$invalid, 'has-success': !form.owner.$invalid}">
                        <label for="owner" class="control-label col-sm-2">소유자</label>
                        <div class="col-sm-10">
                            <input type="text" name="owner" class="form-control" placeholder="소유자/회사명" ng-model="aircraft.owner" />
                            <div class="error-container" ng-show="form.owner.$dirty && form.owner.$invalid">
                                <small class="help-block error" ng-show="form.owner.$error.required">정확한 소유자명을 입력하여 주십시오</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.phone.$invalid, 'has-success': !form.phone.$invalid}">
                        <label for="phone" class="control-label col-sm-2">연락처</label>
                        <div class="col-sm-10">
                            <input type="text" name="phone" class="form-control" value="{{aircraft.phone | lsaRegNo}}" placeholder="전화번호(010-1111-1111)" ng-model="aircraft.phone" ng-pattern=" /^[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}$/" />
                            <div class="error-container" ng-show="form.phone.$dirty && form.phone.$invalid">
                                <small class="help-block error" ng-show="form.phone.$error || form.phone.$error.pattern">정확한 연락처를 입력하여 주십시오(예: 010-1111-1111 등)</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.place.$invalid, 'has-success': !form.place.$invalid}">
                        <label for="place" class="control-label col-sm-2">보관처</label>
                        <div class="col-sm-10">
                            <input type="text" name="place" class="form-control" placeholder="보관처(주소)" ng-model="aircraft.place" />
                            <div class="error-container" ng-show="form.place.$dirty && form.place.$invalid">
                                <small class="help-block error" ng-show="form.place.$error">정확한 보관처를 입력하여 주십시오</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.region.$invalid, 'has-success': !form.region.$invalid}">
                        <label for="region" class="control-label col-sm-2">권역</label>
                        <div class="col-sm-10">
                            <select name="region" ng-init="enums.regions[0].value" ng-model="aircraft.region" ng-options="region.value as region.label for region in enums.regions" class="form-control" ></select>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.acenter.$invalid, 'has-success': !form.acenter.$invalid}">
                        <label for="acenter" class="control-label col-sm-2">관할</label>
                        <div class="col-sm-10">
                            <select name="acenter" ng-init="enums.aCenters[0].value" ng-model="aircraft.acenter" ng-options="acenter.value as acenter.label for acenter in enums.aCenters" class="form-control"></select>
                        </div>
                    </div>
                </div>
            </div> -->
            
           <div class="panel panel-default form-group">
                <div class="panel-heading">기체정보</div>
                <table class="table table-bordered table-condensed" ng-hide="showcmd==='add' && form.place.$invalid">
                    <tbody>
                    <tr class="form-group">
                            <td class="col-sm-2">
                                <label for="lsa_type" class="control-label">기체 종류</label>
                            </td>
                            <td class="col-sm-10" colspan="3">
                                <div class="col-sm-5" ng-class="{'has-error': form.lsa_type.$invalid, 'has-success': !form.lsa_type.$invalid}">
                                    <select name="lsa_type" ng-model="aircraft.lsa_type" ng-options="lsaType.value as lsaType.label for lsaType in aTypes" ng-change="lsaTypeChange(aircraft.lsa_type)" ng-disabled="showcmd!=='add'" class="form-control" required></select>
                                </div>
                                <div class="col-sm-3" ng-hide="showcmd==='add' && !aircraft.lsa_type">
                                    <div class="input-group">
                                        <div ng-class="{'has-error': form.no_seat.$invalid, 'has-success': !form.no_seat.$invalid}">
                                            <input type="number" name="no_seat" class="form-control" placeholder="0~2" ng-model="aircraft.no_seat" min="0" max="2" required/>
                                        </div>
                                        <span class="input-group-addon input-sm">인승</span>
                                    </div>
                                    <div class="error-container" ng-show="form.no_seat.$dirty && form.no_seat.$invalid">
                                        <small class="help-block error" ng-show="form.no_seat.$error.required || form.no_seat.$error">정확한 좌석수를 입력하여 주십시오.(0 ~ 2)</small>
                                    </div>
                                </div>
                                <div class="col-sm-4"  ng-hide="showcmd==='add' && !aircraft.no_seat" ng-class="{'has-error': form.gear_type.$invalid, 'has-success': !form.gear_type.$invalid}">
                                    <select name="gear_type" ng-model="aircraft.gear_type" ng-options="geartype.value as geartype.label for geartype in enums.gearTypes" class="form-control" required></select>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && (!aircraft.lsa_type || !aircraft.no_seat || !aircraft.gear_type)">
                            <td class="col-sm-2">
                                <label for="model" class="control-label">형식</label>
                            </td>
                            <td class="col-sm-10" colspan="3" ng-class="{'has-error': form.model.$invalid, 'has-success': !form.model.$invalid}">
                                <input type="text" name="model" ng-model="aircraft.model" ng-disabled="!aircraft.lsa_type" typeahead="item.model as item.desc for item in aircraftModels | filter:$viewValue" typeahead-on-select="selectModel($item, $model, $label)" class="form-control" required>
                                <div class="error-container" ng-show="form.model.$dirty && form.model.$invalid">
                                    <small class="help-block error" ng-show="form.model.$error.required">형식명을 입력하여 주십시오</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && !aircraft.model">
                            <td class="col-sm-2">
                                <label for="_bld_asm" class="control-label">제작자</label>
                            </td>
                            <td class="col-sm-10" colspan="3" ng-class="{'has-error': form._bld_asm.$invalid, 'has-success': !form._bld_asm.$invalid}">
                                <div class="input-group input-group-sm" style="width:100%">
                                    <select name="_bld_asm" ng-model="aircraft._bld_asm" ng-change="selchange()" ng-options="builder.name for builder in builders track by builder._id" class="form-control" required></select>
                                    <div class="input-group-btn dropdown">
                                        <button type="button" class="btn btn-sm btn-warning dropdown-toggle">
                                            Action<span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a ng-click="builderChange('add', null, 'BLD_ASM')">추가</a></li>
                                            <li><a ng-click="builderChange('mod', aircraft._bld_asm, 'BLD_ASM')">수정</a></li>
                                            <li><a ng-click="builderChange('del', aircraft._bld_asm, 'BLD_ASM')">삭제</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="error-container" ng-show="form._bld_asm.$dirty && form._bld_asm.$invalid">
                                    <small class="help-block error" ng-show="form._bld_asm.$error.required">제작자를 선택하여 주십시오.</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && !aircraft._bld_asm">
                            <td class="col-sm-2">
                                <label for="_bld_kit" class="control-label">키트제작자</label>
                            </td>
                            <td class="col-sm-10" colspan="3" ng-class="{'has-error': form._bld_kit.$invalid, 'has-success': !form._bld_kit.$invalid}">
                                <div class="input-group input-group-sm" style="width:100%">
                                    <select name="_bld_kit" ng-model="aircraft._bld_kit" ng-change="selchange()" ng-options="builder.name for builder in builders track by builder._id" class="form-control" required></select>
                                    <div class="input-group-btn dropdown">
                                        <button type="button" class="btn btn-sm btn-warning dropdown-toggle">
                                            Action<span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a ng-click="builderChange('add', null, 'BLD_ASM')">추가</a></li>
                                            <li><a ng-click="builderChange('mod', aircraft._bld_kit, 'BLD_ASM')">수정</a></li>
                                            <li><a ng-click="builderChange('del', aircraft._bld_kit, 'BLD_ASM')">삭제</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="error-container" ng-show="form._bld_kit.$dirty && form._bld_kit.$invalid">
                                    <small class="help-block error" ng-show="form._bld_kit.$error">키트제작자를 선택하여 주십시오.</small>
                                </div>
                            </td>
                        </tr>
                        <tr class="form-group" ng-hide="showcmd==='add' && !aircraft._bld_kit">
                            <td class="col-sm-2">
                                <label for="sn" class="control-label">일련번호</label>
                            </td>
                            <td class="col-sm-10" colspan="3" ng-class="{'has-error': form.sn.$invalid, 'has-success': !form.sn.$invalid}">
                                <input type="text" name="sn" class="form-control" palceholder="기체 일련번호" ng-model="aircraft.sn" required/>
                                <div class="error-container" ng-show="form.sn.$dirty && form.sn.$invalid">
                                    <small class="help-block error" ng-show="form.sn.$error.required">일련번호를 입력하여 주십시오</small>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- <div class="panel panel-default form-group">
                <div class="panel-heading">기체정보</div>
                <div class="panel-body">
                    <div class="form-group" ng-class="{'has-error': form.lsa_type.$invalid, 'has-success': !form.lsa_type.$invalid}">
                        <label for="lsa_type" class="control-label col-sm-2">기체 종류</label>
                        <div class="col-sm-10">
                            <select id="lsa_type" ng-init="aTypes[0].value" ng-model="aircraft.lsa_type" ng-options="lsaType.value as lsaType.label for lsaType in aTypes" class="form-control"></select>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.no_seat.$invalid, 'has-success': !form.no_seat.$invalid}">
                        <label for="no_seat" class="control-label col-sm-2">좌석수</label>
                        <div class="col-sm-10">
                            <input type="number" name="no_seat" class="form-control" placeholder="0 ~ 2(좌석수)" ng-model="aircraft.no_seat" min="0" max="2" required />
                            <div class="error-container" ng-show="form.no_seat.$dirty && form.no_seat.$invalid">
                                <small class="help-block error" ng-show="form.no_seat.$error.required || form.no_seat.$error">정확한 좌석수를 입력하여 주십시오.(0 ~ 2)</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.gear_type.$invalid, 'has-success': !form.gear_type.$invalid}">
                        <label for="gear_type" class="control-label col-sm-2">기어타입</label>
                        <div class="col-sm-10">
                            <select name="gear_type" ng-init="enums.gearTypes[0].value" ng-model="aircraft.gear_type" ng-options="geartype.value as geartype.label for geartype in enums.gearTypes" class="form-control"></select>
                        </div>
                    </div>
            
                    <div class="form-group" ng-class="{'has-error': form.builder.$invalid, 'has-success': !form.builder.$invalid}">
                        <label for="builder" class="control-label col-sm-2">제작자</label>
                        <div class="col-sm-8">
                            <select name="builder" ng-model="aircraft._bld_asm" ng-change="selchange()" ng-options="builder.name for builder in builders track by builder._id" class="form-control" required></select>
                            <div class="error-container" ng-show="form.builder.$dirty && form.builder.$invalid || !aircraft._bld_asm">
                                <small class="help-block error" ng-show="form.builder.$error || !aircraft._bld_asm">제작자를 선택하여 주십시오.</small>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="btn-group" dropdown>
                                <button type="button" class="btn btn-sm btn-default dropdown-toggle">
                                    제작자<span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a ng-click="builderChange('add', null, 'BLD_ASM')">추가</a></li>
                                    <li><a ng-click="builderChange('mod', aircraft._bld_asm, 'BLD_ASM')">수정</a></li>
                                    <li><a ng-click="builderChange('del', aircraft._bld_asm, 'BLD_ASM')">삭제</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': form.bld_kit.$invalid, 'has-success': !form.bld_kit.$invalid}">
                        <label for="bld_kit" class="control-label col-sm-2">키트제작자</label>
                        <div class="col-sm-10">
                            <select name="bld_kit" ng-model="aircraft._bld_kit" ng-options="builder.name for builder in builders track by builder._id" class="form-control" required></select>
                        </div>
                    </div>
                    <div class="form-group" ng-show="aircraft.lsa_category === 'ULV'" ng-class="{'has-error': form.bld_dsn.$invalid, 'has-success': !form.bld_dsn.$invalid}">
                        <label for="bld_dsn" class="control-label col-sm-2">설계자</label>
                        <div class="col-sm-10">
                            <select name="bld_dsn" ng-init="builders[0]" ng-model="aircraft._bld_dsn" ng-options="builder.name for builder in builders track by builder._id" class="form-control"></select>
                        </div>
                    </div>
                </div>
            </div> -->
            <div class="panel panel-default form-group">
                <div class="panel-heading">장착 부품<small>&nbsp;(필수부품: {{getRequiredCompTypesStr()}})</small></div>
                <table class="table table-condensed table-hover" ng-hide="showcmd==='add' && form.sn.$invalid">
                    <thead>
                        <td class="col-sm-1">종류</td>
                        <td class="col-sm-3">형식</td>
                        <td class="col-sm-2">일련번호</td>
                        <td class="col-sm-2">제작일자</td>
                        <td class="col-sm-1">TSN</td>
                        <td class="col-sm-1">TSO</td>
                        <td class="col-sm-1">상태</td>
                    </thead>
                    <tr ng-repeat="component in aircraft.components">
                        <td>{{enums.COMP_TYPE[component._product.comp_type].label}}</td>
                        <td><span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="top" title="{{component.etc}}"></span>&nbsp;<a ng-click="compStatusChange('mod', component)">{{component._product.model}} {{component._product.sub_model}} {{component._product.revision}}</a></td>
                        <td><input type="text" class="form-control" placeholder="일련번호" ng-model="component.sn" /></td>
                        <td><input type="text" class="form-control" placeholder="제작일자" ng-model="component.mfg_date" /></td>
                        <td><input type="text" class="form-control" placeholder="Time Since New" ng-model="component.tsn" /></td>
                        <td><input type="text" class="form-control" placeholder="Time Since Overhaul" ng-model="component.tso" /></td>
                        <td>
                            <div class="btn-group" dropdown>
                                <button type="button" class="btn btn-sm btn-default dropdown-toggle" ng-disabled="(component._product.comp_type == 'AIRFRAME')">
                                {{getInstalledString(component.installed)}} <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                <li><a ng-click="compStatusChange('install', component)">{{getInstalledString(!component.installed)}}</a></li>
                                <li class="divider"></li>
                                <li><a ng-click="compStatusChange('add', component)">추가</a></li>
                                <li><a ng-click="compStatusChange('mod', component)">수정</a></li>
                                <li><a ng-click="compStatusChange('del', component)">제거</a></li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                    <tfoot>
                        <tr>
                            <td colspan="7" align="right">
                                <button type="button" class="btn btn-primary btn-sm" ng-click="compStatusChange('add', component)" ng-disabled="">
                                    <span class="glyphicon glyphicon-plus"></span>부품 추가
                                </button>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div ng-controller="AFileCtrl" ng-init="init(afiles)" class="form-group">
                <a-files></a-files>
            </div>
            <span class="input-group-btn2">
                <button type="submit" class="btn btn-primary" ng-click="updateAircraft(aircraft)" ng-disabled="form.$invalid || saving">{{txtSubmit}}<i class="fa fa-spinner fa-spin" ng-show="saving"></i></button>
                <button type="submit" class="btn btn-danger" ng-click="deleteAircraft(aircraft)" ng-disabled="form.$invalid || saving">삭제</button>
            </span>
        </fieldset>
      </form>
  </div>
    <a ui-sref="aircraft.list">기체 목록으로 돌아가기</a>
</div>

<!-- Modal -->
<script type="text/ng-template" id="builderModal.html">
<div class="modal-header dialog-header-confirm">
    <button type="button" class="close" ng-click="cancel()">&times;</button>
    <h4 class="modal-title"><span class="glyphicon glyphicon-check"></span>&nbsp;항공기제작자 추가/수정</h4>
</div>
<div class="modal-body">
    <form name="bform" class="form-horizontal" role="form">
        <div class="form-group" ng-class="{'has-error': bform.name.$invalid, 'has-success': !bform.name.$invalid}"> 
            <label for="name" class="control-label col-sm-2">제작자명</label>
            <div class="col-sm-10">
                <input type="text" name="name" ng-model="builder.name" class="form-control" placeholder="Builder name" required/>
                <div class="error-container" ng-show="bform.name.$dirty && bform.name.$invalid">
                    <small class="help-block error" ng-show="bform.name.$error">제작자명을 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="address" class="control-label col-sm-2">주소</label>
            <div class="col-sm-10">
                <input type="text" address="address" ng-model="builder.address" class="form-control" placeholder="Builder address"/>
                <div class="error-container" ng-show="bform.address.$dirty && bform.address.$invalid">
                    <small class="help-block error" ng-show="bform.address.$error">주소를 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="url" class="control-label col-sm-2">홈페이지</label>
            <div class="col-sm-10">
                <input type="url" name="url" ng-model="builder.url" class="form-control" placeholder="Builder homepage url"/>
                <div class="error-container" ng-show="bform.url.$dirty && bform.url.$invalid">
                    <small class="help-block error" ng-show="bform.url.$error">홈페이지를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="email" class="control-label col-sm-2">이메일</label>
            <div class="col-sm-10">
                <input type="email" name="email" ng-model="builder.email" class="form-control" placeholder="Builder email"/>
                <div class="error-container" ng-show="bform.email.$dirty && bform.email.$error.email">
                    <small class="help-block error" ng-show="bform.email.$error.email">이메일을 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="phone" class="control-label col-sm-2">연락처</label>
            <div class="col-sm-10">
                <input type="tel" name="phone" ng-model="builder.phone" class="form-control" placeholder="Builder phone"/>
                <div class="error-container" ng-show="bform.phone.$dirty && bform.phone.$invalid">
                    <small class="help-block error" ng-show="bform.phone.$error">연락처를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="fax" class="control-label col-sm-2">팩스</label>
            <div class="col-sm-10">
                <input type="tel" name="fax" ng-model="builder.fax" class="form-control" placeholder="Builder fax"/>
                <div class="error-container" ng-show="bform.fax.$dirty && bform.fax.$invalid">
                    <small class="help-block error" ng-show="bform.fax.$error">팩스를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal-footer">    
    <button type="button" class="btn btn-primary" ng-click="save()" ng-disabled="bform.$invalid || saving">Save</button>
    <button type="button" class="btn btn-danger" ng-click="cancel()">Cancel</button>
</div>
</script>
<script type="text/ng-template" id="manufacturerModal.html">
<div class="modal-header dialog-header-confirm">
    <button type="button" class="close" ng-click="cancel()">&times;</button>
    <h4 class="modal-title"><span class="glyphicon glyphicon-check"></span>&nbsp;부품 제작자 추가/수정</h4>
</div>
<div class="modal-body">
    <form name="mform" class="form-horizontal" role="form">
        <div class="form-group" ng-class="{'has-error': mform.name.$invalid, 'has-success': !mform.name.$invalid}"> 
            <label for="name" class="control-label col-sm-2">제작자명</label>
            <div class="col-sm-10">
                <input type="text" name="name" ng-model="manufacturer.name" class="form-control" placeholder="Builder name" required/>
                <div class="error-container" ng-show="mform.name.$dirty && mform.name.$invalid">
                    <small class="help-block error" ng-show="mform.name.$error">제작자명을 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="address" class="control-label col-sm-2">주소</label>
            <div class="col-sm-10">
                <input type="text" address="address" ng-model="manufacturer.address" class="form-control" placeholder="Builder address"/>
                <div class="error-container" ng-show="mform.address.$dirty && mform.address.$invalid">
                    <small class="help-block error" ng-show="mform.address.$error">주소를 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="url" class="control-label col-sm-2">홈페이지</label>
            <div class="col-sm-10">
                <input type="url" name="url" ng-model="manufacturer.url" class="form-control" placeholder="Builder homepage url"/>
                <div class="error-container" ng-show="mform.url.$dirty && mform.url.$invalid">
                    <small class="help-block error" ng-show="mform.url.$error">홈페이지를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="email" class="control-label col-sm-2">이메일</label>
            <div class="col-sm-10">
                <input type="email" name="email" ng-model="manufacturer.email" class="form-control" placeholder="Builder email"/>
                <div class="error-container" ng-show="mform.email.$dirty && mform.email.$error.email">
                    <small class="help-block error" ng-show="mform.email.$error.email">이메일을 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="phone" class="control-label col-sm-2">연락처</label>
            <div class="col-sm-10">
                <input type="tel" name="phone" ng-model="manufacturer.phone" class="form-control" placeholder="Builder phone"/>
                <div class="error-container" ng-show="mform.phone.$dirty && mform.phone.$invalid">
                    <small class="help-block error" ng-show="mform.phone.$error">연락처를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
        <div class="form-group"> 
            <label for="fax" class="control-label col-sm-2">팩스</label>
            <div class="col-sm-10">
                <input type="tel" name="fax" ng-model="manufacturer.fax" class="form-control" placeholder="Builder fax"/>
                <div class="error-container" ng-show="mform.fax.$dirty && mform.fax.$invalid">
                    <small class="help-block error" ng-show="mform.fax.$error">팩스를 정확히 입력하여 주십시오.</small>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal-footer">    
    <button type="button" class="btn btn-primary" ng-click="save()" ng-disabled="mform.$invalid || saving">Save</button>
    <button type="button" class="btn btn-danger" ng-click="cancel()">Cancel</button>
</div>
</script>
<script type="text/ng-template" id="componentModal.html">
<div class="modal-header dialog-header-confirm">
    <button type="button" class="close" ng-click="cancel()">&times;</button>
    <h4 class="modal-title"><span class="glyphicon glyphicon-check"></span>&nbsp;부품 추가/수정</h4>
</div>
<div class="modal-body">
    <form name="cform" class="form-horizontal" role="form">      
      <div class="form-group" ng-class="{'has-error': cform.comp_type.$invalid, 'has-success': !cform.comp_type.$invalid}">
            <div class="col-sm-2">
                <label for="comp_type" class="control-label">부품타입</label>
            </div>
            <div class="col-sm-10">
                <select name="comp_type" ng-model="comp_type" ng-options="comptype.value as comptype.label for comptype in comptypes" ng-change="compTypeChange(comp_type)" ng-disabled="cmd === 'mod'" class="form-control"></select>
                <div class="error-container" ng-show="cform.comp_type.$dirty && cform.comp_type.$invalid || !comp_type">
                    <small class="help-block error" ng-show="cform.comp_type.$error || !comp_type">부품타입을 선택하여 주십시오.</small>
                </div>
            </div>
      </div>
      <div class="form-group" ng-show="comp_type" ng-class="{'has-error': cform.model.$invalid, 'has-success': !cform.model.$invalid}">
            <div class="col-sm-2">
                <label for="product" class="control-label">부품형식</label>
            </div>
            <div class="col-sm-10">
                <div class="input-group input-group-sm" style="width:100%">
                    <select name="product" ng-model="product" ng-options="product as product.full_name for product in products_f" ng-disabled="cmd === 'mod'" class="form-control"  placeholder="Select product type"></select>
                    <div class="input-group-btn dropdown">
                        <button type="button" class="btn btn-sm btn-warning dropdown-toggle">
                            Action<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a ng-click="productChange('add', null, comp_type)">추가</a></li>
                            <li ng-show="product"><a ng-click="productChange('mod', product, comp_type)">수정</a></li>
                            <li ng-show="product"><a ng-click="productChange('del', product, comp_type)">삭제</a></li>
                        </ul>
                    </div>
                </div>
                <div class="error-container" ng-show="cform.product.$dirty && cform.product.$invalid  || !product">
                    <small class="help-block error" ng-show="cform.product.$error || !product">부품형식을 선택하여 주십시오.</small>
                </div>
            </div>
      </div>
      <div ng-show="product">
            <div class="form-group"> 
                <div class="col-sm-2">
                    <label for="sn" class="control-label">일련번호</label>
                </div>
                <div class="col-sm-10">
                    <input type="text" name="sn" ng-model="component.sn" class="form-control" placeholder="Serial number"/>
                </div>
            </div>
            <div class="form-group"> 
                <div class="col-sm-2">
                    <label for="mfg_date" class="control-label">제작일자</label>
                </div>
                <div class="col-sm-10">
                    <input type="text" name="mfg_date" ng-model="component.mfg_date" class="form-control" placeholder="2015.01.01"  ng-pattern="/^(19|20)\d{2}\.\d{1,2}\.\d{1,2}$/"/>
                    <div class="error-container" ng-show="cform.mfg_date.$dirty && cform.mfg_date.$invalid">
                        <small class="help-block error" ng-show="cform.mfg_date.$error">정확한 제작일자를 선택하여 주십시오.(예:2015.05.31)</small>
                    </div>
                </div>
            </div>
            <div class="form-group"> 
                <div class="col-sm-2">
                    <label for="tsn" class="control-label">TSN</label>
                </div>
                <div class="col-sm-10">
                    <input type="text" name="tsn" ng-model="component.tsn" class="form-control" placeholder="Time since new" ng-pattern="/^[0-9]*\.?([0-9]+)?$/"/>
                    <div class="error-container" ng-show="cform.tsn.$dirty && cform.tsn.$invalid">
                        <small class="help-block error" ng-show="cform.tsn.$error">TSN을 정확히 입력하여 주십시오(예:100.3)</small>
                    </div>
                </div>
            </div>
            <div class="form-group"> 
                <div class="col-sm-2">
                    <label for="tso" class="control-label">TSO</label>
                </div>
                <div class="col-sm-10">
                    <input type="text" name="tso" ng-model="component.tso" class="form-control" placeholder="Time since overhaul" ng-pattern="/^[0-9]*\.?([0-9]+)?$/"/>
                    <div class="error-container" ng-show="cform.tso.$dirty && cform.tso.$invalid">
                        <small class="help-block error" ng-show="cform.tso.$error">TSO를 정확히 입력하여 주십시오(예:100.3)</small>
                    </div>
                </div>
            </div>
            <div class="form-group"> 
                <div class="col-sm-2">
                    <label for="installed" class="control-label">장착여부</label>
                </div>
                <div class="col-sm-10">
                    <select name="installed" ng-model="component.installed" class="form-control">
                          <option value="true" selected="selected">장착됨</option>
                          <option value="false">탈착됨</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-2">
                    <label for="etc" class="control-label">기타</label>
                </div>
                <div class="col-sm-10">
                    <textarea name="etc" ng-model="component.etc" class="form-control" rows="5"></textarea>
                </div>
            </div>
      </div>      
    </form>
</div>
<div class="modal-footer">    
    <button type="button" class="btn btn-primary" ng-click="save()" ng-disabled="cform.$invalid">Save</button>
    <button type="button" class="btn btn-danger" ng-click="cancel()">Cancel</button>
</div>
</script>
<script type="text/ng-template" id="ProductModal.html">
<div class="modal-header dialog-header-confirm">
    <button type="button" class="close" ng-click="cancel()">&times;</button>
    <h4 class="modal-title"><span class="glyphicon glyphicon-check"></span>&nbsp;부품형식 추가/수정</h4>
</div>
<div class="modal-body">
    <div ng-show="product.model">
        <h4>{{getModelName()}}</h4>
    </div>
    <form name="cform" class="form-horizontal" role="form">      
      <div class="form-group" ng-class="{'has-error': cform.comp_type.$invalid, 'has-success': !cform.comp_type.$invalid}">
            <div class="col-sm-2">
                <label for="comp_type" class="control-label">부품타입</label>
            </div>
            <div class="col-sm-10">
                <select name="comp_type" ng-model="product.comp_type" ng-options="comptype.value as comptype.label for comptype in comptypes" ng-change="compTypeChange(comp_type)" ng-disabled="true" class="form-control"></select>
            </div>
      </div>
      <div class="form-group" ng-show="product.comp_type" ng-class="{'has-error': cform.model.$invalid, 'has-success': !cform.model.$invalid}">
            <div class="col-sm-2">
                <label for="model" class="control-label">모델명</label>
            </div>
            <div class="col-sm-10">
                <div>
                    <div class="col-sm-5">
                        <input type="text" name="model" ng-model="product.model" class="form-control" placeholder="model/type" required/>
                    </div>
                    <div class="col-sm-4">
                        <input type="text" name="sub_model" ng-model="product.sub_model" class="form-control" placeholder="submodel"/>
                    </div>
                    <div class="col-sm-3">
                        <input type="text" name="revision" ng-model="product.revision" class="form-control" placeholder="revision"/>
                    </div>
                </div>
                <div class="error-container" ng-show="cform.model.$dirty && cform.model.$invalid  || !product.model">
                    <small class="help-block error" ng-show="cform.model.$error || !model">모델명을 입력하여 주십시오.</small>
                </div>
            </div>
      </div>
      <div class="form-group" ng-show="product.comp_type" ng-class="{'has-error': cform.model.$invalid, 'has-success': !cform.model.$invalid}">
            <div class="col-sm-2">
                <label for="_manufacturer" class="control-label">제작자</label>
            </div>
            <div class="col-sm-10">
                <div class="input-group input-group-sm" style="width:100%">
                    <select name="_manufacturer" ng-model="product._manufacturer" ng-options="manufacturer.name for manufacturer in manufacturers track by manufacturer._id" class="form-control" required></select>
                    <div class="input-group-btn dropdown">
                        <button type="button" class="btn btn-sm btn-warning dropdown-toggle">
                            Action<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a ng-click="mfgChange('add', null)">추가</a></li>
                            <li ng-show="product._manufacturer"><a ng-click="mfgChange('mod', product._manufacturer)">수정</a></li>
                            <li ng-show="product._manufacturer"><a ng-click="mfgChange('del', product._manufacturer)">삭제</a></li>
                        </ul>
                    </div>
                </div>
                <div class="error-container" ng-show="form._manufacturer.$dirty && form._manufacturer.$invalid">
                    <small class="help-block error" ng-show="form._manufacturer.$error">제작자를 선택하여 주십시오.</small>
                </div>
            </div>
      </div>
    </form>
</div>
<div ng-controller="AFileCtrl" class="form-group">
    <a-files></a-files>
</div>
<div class="modal-footer">    
    <button type="button" class="btn btn-primary" ng-click="save()" ng-disabled="cform.$invalid">Save</button>
    <button type="button" class="btn btn-danger" ng-click="cancel()">Cancel</button>
</div>
</script>

